/*
 * Mu plugin collection v0.2.2
 * <http://github.com/tuomas/jquery-mu>
 *
 * Requires jQuery 1.3.2 or 1.4.
 *
 * Copyright (c) 2009-2010 Tuomas Kareinen, Reaktor Innovations Oy
 * Licensed under the MIT license.
 *
 * Portions based on code from jquery.highlight-3.js.
 * Copyright (c) 2007 Johann Burkard, <http://johannburkard.de>
 * Licensed under the MIT license.
 */
(function(a){if(!a.mu){a.mu={}}})(jQuery);(function(a){a.util={createPseudoUniqueId:function(){return Math.floor(Math.random()*999999)}}})(jQuery.mu);(function(b,d){var a=(function(g){var f=false;function e(){return d(document).queue(g).length===0}return{queue:function(h){d(document).queue(g,function(){f=true;h()});if(!f){d(document).dequeue(g)}return d(document).queue(g).length},dequeue:function(){if(!e()){d(document).dequeue(g)}else{f=false}}}})("MuQueue"+b.util.createPseudoUniqueId());function c(f){if(f.callsComplete){var e=f.complete;f.complete=function(){if(e){e.apply(this,arguments)}a.dequeue()}}return a.queue(function(){f();if(!f.callsComplete){a.dequeue()}})}b.queue={action:c,ajax:function(f){var e=f.complete;f.complete=function(){if(e){e.apply(this,arguments)}g.complete()};function g(){d.ajax(f)}g.callsComplete=true;c(g)}}})(jQuery.mu,jQuery);(function(c,e){var f=c.util.createPseudoUniqueId();e.expr[":"].muContainsIgnoringCase=function(j,i,l,g){var k=(j.textContent||j.innerText||e(j).text()||"").toLowerCase(),h=l[3].toLowerCase();return k.indexOf(h)>=0};function b(g){return"MuSearchForm"+(g?g:"")+f}function a(g){return"muSearchForm"+(g?g:"")}function d(g,h){e.each(h,function(i,j){g=g.filter(":muContainsIgnoringCase("+j+")")});return g}e.fn.muSearchForm=function(n){var l=e.extend({formId:b(),formClass:a(),inputId:b("Input"),inputClass:a("Input"),loaderId:b("Loader"),loaderClass:a("Loader"),highlightClass:null,loadWith:null,attachWith:function(H){e("body").append(H)},filterElementsToShowWith:d,delay:500,formScope:e(document),setTimeoutWith:window.setTimeout,clearTimeoutWith:window.clearTimeout},n),w=e(this),A=l.formScope,o=null,j=l.clearTimeoutWith,g=l.setTimeoutWith,v=l.loadWith&&l.loaderId,s=l.filterElementsToShowWith,q=l.highlightClass!==null,F=null,i="a-z0-9._\\-!?@#";function G(){return"<input type='text' value='' id='"+l.inputId+"' class='"+l.inputClass+"' />"}function E(){if(v){var H=e("<span id='"+l.loaderId+"' class='"+l.loaderClass+"'>"+l.loadWith()+"</span>");H.hide();return H}else{return""}}function r(){var H=e("<form action='#' id='"+l.formId+"' class='"+l.formClass+"'>"+G()+"</form>");H.append(E());return H}function m(K){var H=[],L=K.length,I,J;for(I=0;I<L;I++){J=K[I];if(H.indexOf(J)<0){H.push(J)}}return H}function t(H){H=H.replace(/\s+/g," ");H=H.replace(new RegExp("[^"+i+"\\s]","gi"),"");H=e.trim(H);if(H.length>0){return m(H.split(/\s+/)).sort(function(J,I){return I.length-J.length})}else{return[]}}function D(I,K){if(I.nodeType==Node.TEXT_NODE){var L=I.data.toLowerCase().indexOf(K),J,H;if(L>=0){J=I.splitText(L);J.splitText(K.length);H=h(J.cloneNode(true));J.parentNode.replaceChild(H,J)}}else{if(I.nodeType==Node.ELEMENT_NODE&&I.className!=F&&I.childNodes&&!/(script|style)/i.test(I.tagName)){e.each(I.childNodes,function(M,N){D(N,K)})}}}function h(H){var I=document.createElement("span");I.className=F;I.appendChild(H);return I}function C(H,I){H.each(function(){var J=this;e.each(I,function(K,L){D(J,L.toLowerCase())})})}function B(H){H.find("span."+F).each(function(){var I=this.parentNode;I.replaceChild(this.firstChild,this);I.normalize()})}function y(H){var I,J;if(q){B(w)}J=t(H);if(J.length>0){w.hide();I=s(w,J);if(q){C(I,J)}I.show()}else{w.show()}}function k(){u(true)}function z(){u(false)}function u(I){var H;if(v){H=A.find("span#"+l.loaderId);if(I){H.show()}else{H.hide()}}}function p(H){var I=l.delay/2;if(o){j(o)}o=g(function(){k();g(function(){y(H)},I);g(function(){z()},I)},I)}function x(){l.attachWith(r());A.find("input#"+l.inputId).keyup(function(){var H=e(this).val();p(H)})}if(q){F=l.highlightClass}x();return this}})(jQuery.mu,jQuery);